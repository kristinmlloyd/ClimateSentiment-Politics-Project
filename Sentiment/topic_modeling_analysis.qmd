---
title: "Topic Modeling Analysis"
author: "Kristin Lloyd"
format: 
  html:
    toc: true
    embed-resources: true
    code-fold: true
---

```{r}

options(repos = c(CRAN = "https://cran.rstudio.com"))
install.packages("tidyverse")
library(tidyverse)
install.packages("wordcloud")
library(wordcloud)
library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)

```

## Senators 

Let’s load the dataset and analyze the topics generated by the model. This will provide valuable insights into how senators discuss climate change, highlighting key areas of focus.

```{r}

df <- read.csv("../Data/processed-data/Senators_final.csv")

```

Let’s explore the most frequently used words in the senators' statements by creating a bar chart to visualize the distribution.

```{r}

word_frequencies <- df %>%
  mutate(words = strsplit(as.character(dominant_topic), ",|\\s+")) %>%
  unnest(words) %>%
  filter(words != "") %>%  
  group_by(words) %>%
  summarise(
    frequency = n(),
    .groups = 'drop'
  ) %>%
  arrange(desc(frequency)) %>%
  head(20)  

ggplot(word_frequencies, aes(x = reorder(words, frequency), y = frequency)) +
  geom_bar(stat = "identity", fill = "#FF5733") +
  coord_flip() + 
  geom_text(aes(label = frequency), hjust = 1.2, color = "black", size = 3.5) + 
  labs(
    title = "Top 20 Most Frequent Words in Topics",
    x = "Words",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.text.y = element_text(size = 10)
  )

```

 These words emphasize the focus on climate-related issues, for example energy transitions and American jobs. Words like "action," "impact," and "crisis" highlight the urgency associated with these discussions. Let's create a word cloud for easier readbility. 

```{r}

word_frequencies <- df %>%
  mutate(words = strsplit(as.character(dominant_topic), ",|\\s+")) %>%
  unnest(words) %>%
  filter(words != "") %>%
  group_by(words) %>%
  summarise(
    frequency = n(),
    .groups = 'drop'
  ) %>%
  arrange(desc(frequency)) 

wordcloud(
  words = word_frequencies$words, 
  freq = word_frequencies$frequency, 
  min.freq = 2,  
  max.words = 100,  
  random.order = FALSE,  
  colors = brewer.pal(8, "Dark2")  
)

```

Next, let’s examine the most frequently occurring words by Democrat and Republican senators.

```{r}

word_party_frequencies <- df %>%
  mutate(words = strsplit(as.character(dominant_topic), ",|\\s+")) %>%
  unnest(words) %>%
  filter(words != "", !words %in% c("and", "the")) %>%
  group_by(party, words) %>%
  summarise(
    frequency = n(),
    .groups = 'drop'
  ) %>%
  arrange(party, desc(frequency))

top_party_words <- word_party_frequencies %>%
  group_by(party) %>%
  slice_head(n = 10) %>%
  ungroup()

ggplot(top_party_words, aes(x = reorder(words, frequency), 
                            y = frequency)) +
  geom_bar(stat = "identity", fill = "#FF5733") +
  facet_wrap(~party, scales = "free_y") +
  coord_flip() +
  geom_text(aes(label = frequency), hjust = 1.2, color = "black", size = 3) + 
  labs(
    title = "Top 10 Most Frequent Words by Party",
    x = "Words",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.text = element_text(size = 10),
    strip.text = element_text(size = 12, face = "bold")
  )

```

While there are not major differences, one observation is that the word "new" appears in Republican's top ten words. This is interesting because it suggests that Republicans may want to find a new way to approach climate change. Democrats often want to take aggression action whereas Republicans want to try new approaches.

```{r}

word_region_frequencies <- df %>%
  mutate(words = strsplit(as.character(dominant_topic), ",|\\s+")) %>%
  unnest(words) %>%
  filter(words != "") %>%  
  filter(words != "and") %>%  
  group_by(region, words) %>%
  summarise(
    frequency = n(),
    .groups = 'drop'
  ) %>%
  arrange(region, desc(frequency))

top_region_words <- word_region_frequencies %>%
  group_by(region) %>%
  slice_head(n = 10) %>%
  ungroup()

ggplot(top_region_words, aes(x = reorder(words, frequency), 
                           y = frequency)) +
  geom_bar(stat = "identity", fill = "#FF5733") +
  facet_wrap(~region, scales = "free_y") +
  coord_flip() +
  labs(
    title = "Top 10 Most Frequent Words by Region",
    x = "Words",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.text = element_text(size = 10),
    strip.text = element_text(size = 12, face = "bold")
  ) +
  geom_text(aes(label = frequency), hjust = -0.2)

```

There are no noticeable differences in topic and region.

## President

```{r}

df_president <- read.csv("../Data/processed-data/President_final.csv")

```

```{r}

word_frequencies <- df_president %>%
  mutate(words = strsplit(as.character(dominant_topic), ",|\\s+")) %>%
  unnest(words) %>%
  filter(words != "") %>%  
  group_by(words) %>%
  summarise(
    frequency = n(),
    .groups = 'drop'
  ) %>%
  arrange(desc(frequency)) %>%
  head(20)  

ggplot(word_frequencies, aes(x = reorder(words, frequency), y = frequency)) +
  geom_bar(stat = "identity", fill = "#FF5733") +
  coord_flip() + 
  geom_text(aes(label = frequency), hjust = 1.2, color = "black", size = 3.5) +  # Labels inside the bars
  labs(
    title = "Top 20 Most Frequent Words in Topics",
    x = "Words",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.text.y = element_text(size = 10)
  )

```

```{r}

word_frequencies <- df_president %>%
  mutate(words = strsplit(as.character(dominant_topic), ",|\\s+")) %>%
  unnest(words) %>%
  filter(words != "") %>%
  group_by(words) %>%
  summarise(
    frequency = n(),
    .groups = 'drop'
  ) %>%
  arrange(desc(frequency)) 

wordcloud(
  words = word_frequencies$words, 
  freq = word_frequencies$frequency, 
  min.freq = 2,  
  max.words = 100,  
  random.order = FALSE,  
  colors = brewer.pal(8, "Dark2")  
)

```

The President's sentiment differs significantly from that of the senators. While he frequently mentions climate change and global warming, four of his top words—"cold," "freezing," "snow," and "ice"—highlight his tendency to joke about cold weather as a counterpoint to global warming. As President of the United States, one might expect a more serious focus on climate-related topics. However, it is important to note that his sentiment analysis spans back to 2013, whereas the senators sentiments are all recent. 